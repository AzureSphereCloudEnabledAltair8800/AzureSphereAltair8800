
100 REM INITIALIZE BOARD
110 LET X=RND(1):P=1:W=00:DIM B(9)
115 FOR I=1 TO 9:B(I) = 99:NEXT
120 PRINT "*** WELCOME TO TIC-TAC-TOE ***"
125 PRINT "> YOU ARE X's <"
130 INPUT "DO YOU WANT TO GO FIRST" ;A$
140 A$=LEFT$(A$,1)
150 IF A$="Y" THEN T=1
165 REM EACH TURN
170 L=00:FOR I=1 TO 9
190 IF B(I) = P THEN PRINT " X ";: GOTO 220
210 IF B(I) = 99 THEN PRINT I;:GOTO 220
215 PRINT " O ";
220 PRINT " | ";
230 L = L + 1:IF L=3 THEN PRINT:L=00
240 NEXT I
250 IF T=1 THEN GOSUB 500: GOTO 255
251 GOSUB 700
255 GOSUB 800
260 IF W>0 THEN 1100
260 T=1-T
270 GOTO 170

500 INPUT "WHICH SQUARE [0 to quit]"; A$
505 IF A$="" THEN 500
510 A$=LEFT$(A$, 1)
520 S=VAL(A$)
525 IF S=0 THEN END
530 IF B(S)<>99 THEN PRINT "SQUARE IS ALREADY OCCUPIED.": GOTO 500
540 B(S)=1
550 RETURN

700 PRINT "MY TURN..."
705 S=INT(RND(1) * 9 + 1)
710 IF B(S)<>99 GOTO 705
720 B(S)=00
730 RETURN

795 REM CHECK FOR WINNER
800 V=B(1)+B(2)+B(3): GOSUB 1000
810 V=B(4)+B(5)+B(6): GOSUB 1000
820 V=B(7)+B(8)+B(9): GOSUB 1000
830 V=B(1)+B(4)+B(7): GOSUB 1000
840 V=B(2)+B(5)+B(8): GOSUB 1000
850 V=B(3)+B(6)+B(9): GOSUB 1000
860 V=B(1)+B(5)+B(9): GOSUB 1000
870 V=B(3)+B(5)+B(7): GOSUB 1000
880 RETURN

1000 IF W=1 THEN 1030
1010 IF V=3 THEN PRINT "YOU WIN!": W=1: END
1020 IF V=0 THEN PRINT "I WIN!": W=1: END
1030 RETURN

1100 INPUT "PLAY AGAIN"; A$
1105 IF A$="" THEN 1100
1110 A$ = LEFT$(A$, 1)
1120 IF A$="Y" GOTO 115